# ðŸš€ FastAPI Project Setup Guide

This guide will help you get the FastAPI server up and running using [`uv`](https://github.com/astral-sh/uv), a modern Python package manager and runtime.

---

## ðŸ“¦ Step 1: Install `uv`

If you don't already have `uv` installed, you can install it with one of the following methods:

### MacOS / Linux

```bash
curl -Ls https://astral.sh/uv/install.sh | bash
```

### Windows (PowerShell)

```powershell
irm https://astral.sh/uv/install.ps1 | iex
```

Alternatively, check out the [official uv installation docs](https://github.com/astral-sh/uv#installation) for more options.

---

## ðŸ§ª Step 2: Create a Virtual Environment and Run the App

```bash
uv run main.py
```

> This will automatically create a `.venv` folder for your project if one doesn't already exist.

---

## ðŸ“¥ Step 3: Install Dependencies

Install the project dependencies using:

```bash
uv add -r requirements.txt
```

This installs everything listed in `requirements.txt` and locks them using `uv.lock` for reproducibility.

---

## ðŸ–¥ï¸ Step 4: Run the Server
### Start the Server
Start the FastAPI development server to run your server:

```bash
uv run uvicorn main:app --reload
```

---

### Access the API 
Once the server is running, open your browser and navigate to:

```
http://127.0.0.1:8000
```

Or hold `Cmd` (Mac) or `Ctrl` (Windows/Linux) and click the link in your terminal.

---

## Step 5: ðŸ” Configure Environment Variables

We use a `.env` file to manage configuration, like database URLs.
1. Go to **Supabase > Database > Connect**
  * ![img.png](img.png)

2. In the modal that appears, look for the **Direct Connection** section at the top:
  * ![img_1.png](img_1.png)

3. Use the `.env_example` file as a template to create your own `.env`.

4. Set the `DATABASE_URL` environment variable using:
    - The **DB password**
    - The **hostname** shown under **Direct Connection**

## ðŸ§± Step 6. Database & Model Setup

We're using [Supabase](https://supabase.com/) (PostgreSQL) as our database.

- SQLModel handles our models
- Supabase manages the DB and connection pooling
- Environment variables are loaded from `.env` (see `.env.example`)

For example, the `providers` table includes automatic timestamp tracking:

```
from sqlmodel import SQLModel, Field, Column, DateTime, text
created_at: Optional[datetime] = Field(
        default=None,
        sa_column=Column(DateTime(timezone=True),
        server_default=text("(now() AT TIME ZONE 'utc')")
        )
    )
```
This ensures timestamps are generated by Postgres itself (not Python), guaranteeing accuracy and consistency in UTC. See commit [fix: user server defaults for created_at and updated_at](https://github.com/dsd-cohort-team-corgi/backend/pull/18/commits/7f8b3211a259705534fdfaba86f0591c07e0caee) for implementation details.

## ðŸ§ª [Optional] Seed the Database
To test your database connection or seed example data (e.g. into the `providers` table), you can run the following:

```
uv run test_db.py
```

### âœ… You're Ready!

You can now build and test your FastAPI backend locally. Happy coding!


# Notes

## Dependency Management

### Add Dependencies
```
uv add dependency name
```
### Remove Dependences
```
uv pip uninstall package-name
uv remove package-name
uv sync
```